{% extends 'main.html' %}
{% load static %}

{% block content %}

<main id="main" style="min-height: 70vh; padding-top: 80px;">
    <div class="container">
        <div class="section-title mt-3 pb-0">
            <h2><i class="bi bi-megaphone-fill"></i> Notice Board</h2>
            <p style="font-size: large; font-weight: 600;">
                <span class="badge bg-success px-3 py-2" style="font-size: 1rem;">
                    <i class="bi bi-shield-check"></i> Members Only
                </span>
            </p>
            <p style="font-size: medium; color: #6c757d; margin-top: 10px;">
                Exclusive announcements and updates for registered members
            </p>
        </div>

        <section class="about py-4">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-xl-10 col-lg-11">
                        <div id="noticesList" class="notices-list">
                            <!-- Notices will be loaded dynamically -->
                            <div class="text-center py-5">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-3">Loading notices...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<style>
    .notice-card {
        background: #fff;
        border-left: 4px solid #007bff;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .notice-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .notice-card.new {
        border-left-color: #28a745;
    }
    
    .notice-date {
        color: #6c757d;
        font-size: 0.9rem;
        font-weight: 500;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .notice-content {
        color: #333;
        font-size: 1.1rem;
        line-height: 1.6;
        margin-bottom: 10px;
    }
    
    .notice-link {
        display: inline-block;
        color: #007bff;
        text-decoration: none;
        font-weight: 600;
        margin-top: 10px;
        transition: color 0.2s;
    }
    
    .notice-link:hover {
        color: #0056b3;
        text-decoration: underline;
    }
    
    .no-notices {
        text-align: center;
        padding: 60px 20px;
        color: #6c757d;
    }
    
    .no-notices i {
        font-size: 4rem;
        margin-bottom: 20px;
        opacity: 0.5;
    }
    
    .new-badge {
        background: #28a745;
        color: white;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
</style>

<script>
    async function loadNotices() {
        try {
            const response = await fetch('/api/get-notices/');
            const data = await response.json();
            
            const noticesList = document.getElementById('noticesList');
            
            if (data.success && data.notices && data.notices.length > 0) {
                noticesList.innerHTML = '';
                
                data.notices.forEach((notice, index) => {
                    const noticeDate = new Date(notice.date_time);
                    const now = new Date();
                    const daysDiff = Math.floor((now - noticeDate) / (1000 * 60 * 60 * 24));
                    const isNew = daysDiff <= 7; // Consider notices less than 7 days old as "new"
                    
                    const noticeCard = document.createElement('div');
                    noticeCard.className = 'notice-card' + (isNew ? ' new' : '');
                    
                    noticeCard.innerHTML = `
                        <div class="notice-date">
                            <i class="bi bi-calendar3"></i>
                            ${noticeDate.toLocaleDateString('en-US', { 
                                year: 'numeric', 
                                month: 'long', 
                                day: 'numeric' 
                            })}
                            ${isNew ? '<span class="new-badge ms-2">New</span>' : ''}
                        </div>
                        <div class="notice-content">
                            ${notice.announcement}
                        </div>
                        ${notice.hyper_link ? `
                            <a href="${notice.hyper_link}" target="_blank" class="notice-link">
                                <i class="bi bi-link-45deg"></i> View More
                            </a>
                        ` : ''}
                    `;
                    
                    noticesList.appendChild(noticeCard);
                });
            } else {
                noticesList.innerHTML = `
                    <div class="no-notices">
                        <i class="bi bi-inbox"></i>
                        <h4>No Notices Available</h4>
                        <p>Check back later for updates and announcements.</p>
                    </div>
                `;
            }
        } catch (error) {
            console.error('Error loading notices:', error);
            document.getElementById('noticesList').innerHTML = `
                <div class="no-notices">
                    <i class="bi bi-exclamation-triangle"></i>
                    <h4>Error Loading Notices</h4>
                    <p>Unable to load notices at this time. Please try again later.</p>
                </div>
            `;
        }
    }
    
    // Load notices when page loads
    document.addEventListener('DOMContentLoaded', loadNotices);
</script>

{% endblock content %}

